<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® - Ù„Ù„Ø£Ø­Ø°ÙŠØ©</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&amp;display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              light: '#6abe4b', 
              DEFAULT: '#4a8c32', 
              dark: '#356624',
              accent: '#f3f4f6'
            }
          }
        }
      }
    }
  </script>
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Cairo', sans-serif;
      background-color: #121212;
      color: #ffffff;
    }
    
    /* === ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„ØªØ´Ù…Ù„ Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙƒØ¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ© === */
    .brand-bg {
      /* Ø·Ø¨Ù‚Ø© Ù„ÙˆÙ†ÙŠØ© Ø¯Ø§ÙƒÙ†Ø© + Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø´ÙØ§Ù ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© */
      background-image: 
        linear-gradient(rgba(18, 18, 18, 0.92), rgba(18, 18, 18, 0.95)),
        url('1000231796.png'); /* Ù‡Ù†Ø§ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ù„ÙˆØ¬Ùˆ Ù„Ù„Ø®Ù„ÙÙŠØ© */
      background-size: cover; /* ØªØºØ·ÙŠØ© Ø§Ù„ØµÙØ­Ø© */
      background-position: center;
      background-attachment: fixed; /* ØªØ«Ø¨ÙŠØª Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ */
      background-repeat: no-repeat;
    }

    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø²Ø¬Ø§Ø¬ */
    .glass-effect {
      background: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(15px);
      border-bottom: 1px solid rgba(74, 140, 50, 0.2);
    }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
    .btn-primary {
      background: linear-gradient(135deg, #4a8c32 0%, #356624 100%);
      transition: all 0.3s ease;
      border: 1px solid #6abe4b;
    }
    .btn-primary:hover {
      background: linear-gradient(135deg, #6abe4b 0%, #4a8c32 100%);
      box-shadow: 0 0 20px rgba(74, 140, 50, 0.6);
      transform: translateY(-2px);
    }

    .product-card {
      background: linear-gradient(145deg, #1e1e1e 0%, #151515 100%);
      border: 1px solid #333;
      transition: all 0.3s ease;
    }
    .product-card:hover {
      border-color: #4a8c32;
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(74, 140, 50, 0.1);
    }

    /* Ø³ØªØ§ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
    .size-btn.selected { background: #4a8c32; color: #fff; border-color: #6abe4b; }
    .size-btn.unavailable { background: #1a1a1a; color: #444; cursor: not-allowed; text-decoration: line-through; }
    .modal-overlay { background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(8px); }
    .input-field { background: #2d2d2d; border: 1px solid #444; color: white; }
    .input-field:focus { border-color: #4a8c32; }
    
    .animate-fade-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  </style>
 </head>
 <body class="h-full brand-bg min-h-screen overflow-auto">
  <div id="app" class="min-h-full w-full">
   
   <div id="home-page" class="min-h-full w-full">
    
    <header class="glass-effect p-3 sticky top-0 z-50">
     <div class="max-w-6xl mx-auto flex justify-between items-center">
      <div class="flex items-center gap-3">
        <div class="w-12 h-12 bg-white/5 rounded-lg p-1 flex items-center justify-center border border-white/10">
            <img src="Ø§Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® (3).png" alt="Logo" class="w-full h-full object-contain">
        </div>
        <div>
            <h1 id="store-title" class="text-xl md:text-2xl font-bold text-white tracking-wide leading-none">Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ®</h1>
            <span class="text-xs text-brand font-bold tracking-widest">SHOES STORE</span>
        </div>
      </div>
      <button onclick="showAdminLogin()" class="px-4 py-2 rounded-lg text-sm bg-white/5 hover:bg-white/10 border border-white/10 transition-all"> ğŸ” </button>
     </div>
    </header>

    <section class="relative h-72 md:h-96 flex items-center justify-center overflow-hidden">
     <div class="absolute w-full h-full bg-gradient-to-t from-[#121212] to-transparent bottom-0"></div>
     
     <div class="text-center px-4 relative z-10">
      <img src="1000231796.png" class="h-24 mx-auto mb-6 opacity-80 animate-fade-in drop-shadow-2xl" alt="Logo Banner">
      <h2 class="text-3xl md:text-5xl font-black mb-4 animate-fade-in">
        Ø®Ø·ÙˆØ§ØªÙƒ ØªØ¨Ø¯Ø£ <span class="text-brand">Ù‡Ù†Ø§</span>
      </h2>
      <button onclick="document.getElementById('categories-section').scrollIntoView({behavior: 'smooth'})" class="btn-primary text-white px-8 py-3 rounded-full font-bold mt-4 shadow-lg shadow-brand/20">
        ØªØµÙØ­ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… â†“
      </button>
     </div>
    </section>

    <section id="categories-section" class="max-w-6xl mx-auto px-4 py-12">
     <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
       <button onclick="selectCategory('Ø±Ø¬Ø§Ù„ÙŠ')" class="product-card p-6 rounded-2xl group text-right relative overflow-hidden">
         <div class="absolute -left-4 -bottom-4 text-8xl opacity-5 group-hover:scale-110 transition-transform">ğŸ‘</div>
         <h4 class="text-2xl font-bold mb-1 text-white group-hover:text-brand transition-colors">Ø±Ø¬Ø§Ù„ÙŠ</h4>
         <p class="text-gray-400 text-sm">Ø£Ø­Ø°ÙŠØ© ÙƒÙ„Ø§Ø³ÙŠÙƒ ÙˆØ±ÙŠØ§Ø¶ÙŠØ©</p>
         <div class="mt-4 inline-block px-3 py-1 bg-brand/10 text-brand rounded text-sm font-bold">ØªØµÙØ­ Ø§Ù„Ø¢Ù† â†</div>
       </button>
       
       <button onclick="selectCategory('Ø­Ø±ÙŠÙ…ÙŠ')" class="product-card p-6 rounded-2xl group text-right relative overflow-hidden">
         <div class="absolute -left-4 -bottom-4 text-8xl opacity-5 group-hover:scale-110 transition-transform">ğŸ‘ </div>
         <h4 class="text-2xl font-bold mb-1 text-white group-hover:text-brand transition-colors">Ø­Ø±ÙŠÙ…ÙŠ</h4>
         <p class="text-gray-400 text-sm">Ø£Ù†Ø§Ù‚Ø© Ù„ÙƒÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª</p>
         <div class="mt-4 inline-block px-3 py-1 bg-brand/10 text-brand rounded text-sm font-bold">ØªØµÙØ­ Ø§Ù„Ø¢Ù† â†</div>
       </button>
       
       <button onclick="selectCategory('Ø£Ø·ÙØ§Ù„ÙŠ')" class="product-card p-6 rounded-2xl group text-right relative overflow-hidden">
         <div class="absolute -left-4 -bottom-4 text-8xl opacity-5 group-hover:scale-110 transition-transform">ğŸ‘Ÿ</div>
         <h4 class="text-2xl font-bold mb-1 text-white group-hover:text-brand transition-colors">Ø£Ø·ÙØ§Ù„ÙŠ</h4>
         <p class="text-gray-400 text-sm">Ø±Ø§Ø­Ø© Ù„Ù„Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„ØµØºØ§Ø±</p>
         <div class="mt-4 inline-block px-3 py-1 bg-brand/10 text-brand rounded text-sm font-bold">ØªØµÙØ­ Ø§Ù„Ø¢Ù† â†</div>
       </button>
     </div>
    </section>

    <section id="products-section" class="max-w-6xl mx-auto px-4 py-8 hidden min-h-screen">
     <div class="flex justify-between items-center mb-8 sticky top-20 z-40 py-4 bg-[#121212]/95 backdrop-blur-md border-b border-gray-800">
      <h3 id="category-title" class="text-xl font-bold text-white border-r-4 border-brand pr-3">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
      <button onclick="goHome()" class="text-gray-400 hover:text-white flex items-center gap-2 text-sm">
        <span>âœ• Ø¥ØºÙ„Ø§Ù‚</span>
      </button>
     </div>
     
     <div id="products-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6"></div>
     <div id="no-products" class="text-center py-20 text-gray-600 hidden">
      <p class="text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>
     </div>
    </section>
   </div>

   <div id="product-modal" class="fixed inset-0 z-[60] hidden modal-overlay flex items-center justify-center p-4">
    <div class="bg-[#1e1e1e] text-white rounded-2xl max-w-md w-full max-h-[90%] overflow-y-auto border border-gray-700 shadow-2xl animate-fade-in">
     <div class="relative h-64 bg-gradient-to-b from-gray-800 to-[#1e1e1e] flex items-center justify-center p-4">
       <button onclick="closeProductModal()" class="absolute top-4 left-4 bg-black/40 hover:bg-black/60 w-8 h-8 rounded-full text-white z-10">âœ•</button>
       <div id="modal-product-image" class="w-full h-full flex items-center justify-center"></div>
     </div>
     
     <div class="p-6">
      <div class="flex justify-between items-start mb-4">
        <h3 id="modal-product-name" class="text-xl font-bold"></h3>
        <span id="modal-product-price" class="text-lg font-bold text-brand"></span>
      </div>
      
      <div class="mb-6">
       <p class="text-xs text-gray-400 mb-2">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³:</p>
       <div id="modal-sizes" class="flex flex-wrap gap-2"></div>
      </div>
      
      <div class="space-y-3 pt-4 border-t border-gray-700">
        <input type="text" id="customer-name" placeholder="Ø§Ù„Ø§Ø³Ù…" class="w-full px-4 py-3 rounded-xl input-field outline-none">
        <input type="tel" id="customer-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" class="w-full px-4 py-3 rounded-xl input-field outline-none">
        <input type="text" id="customer-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" class="w-full px-4 py-3 rounded-xl input-field outline-none">
        <button onclick="submitOrder()" class="w-full btn-primary text-white py-3 rounded-xl font-bold mt-2">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
      </div>
     </div>
    </div>
   </div>

   <div id="admin-login-modal" class="fixed inset-0 z-[60] hidden modal-overlay flex items-center justify-center p-4">
    <div class="bg-[#1e1e1e] border border-gray-700 text-white rounded-2xl max-w-sm w-full p-8 text-center shadow-2xl">
     <img src="1000231796.png" class="w-16 h-16 mx-auto mb-4 object-contain">
     <h3 class="text-xl font-bold mb-6">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
     <input type="password" id="admin-password" placeholder="Password" class="w-full px-4 py-3 rounded-xl input-field outline-none mb-4 text-center">
     <div class="flex gap-2">
       <button onclick="checkAdminPassword()" class="flex-1 btn-primary py-2 rounded-xl">Ø¯Ø®ÙˆÙ„</button>
       <button onclick="closeAdminLogin()" class="flex-1 bg-gray-700 py-2 rounded-xl">Ø¥Ù„ØºØ§Ø¡</button>
     </div>
    </div>
   </div>

   <div id="admin-page" class="hidden min-h-screen bg-[#121212]">
    <header class="p-4 border-b border-gray-800 flex justify-between items-center bg-[#1e1e1e]">
      <h1 class="font-bold flex items-center gap-2"><span class="bg-brand px-2 rounded text-xs">ADMIN</span> Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</h1>
      <button onclick="exitAdmin()" class="text-sm text-gray-400">Ø®Ø±ÙˆØ¬</button>
    </header>
    <div class="max-w-4xl mx-auto p-4">
      <div class="flex gap-2 mb-6 overflow-x-auto">
        <button onclick="showAdminTab('products')" class="px-4 py-2 bg-brand rounded-lg text-sm font-bold">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
        <button onclick="showAdminTab('orders')" class="px-4 py-2 bg-gray-800 rounded-lg text-sm font-bold">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
        <button onclick="showAdminTab('add')" class="px-4 py-2 bg-gray-800 rounded-lg text-sm font-bold">Ø¥Ø¶Ø§ÙØ© +</button>
      </div>
      <div id="admin-products" class="space-y-2"></div>
      <div id="admin-orders" class="hidden space-y-2"></div>
      <div id="admin-add" class="hidden bg-[#1e1e1e] p-6 rounded-xl border border-gray-700">
        <h3 class="font-bold mb-4 border-b border-gray-700 pb-2">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h3>
        <div class="space-y-3">
          <input id="new-product-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" class="w-full p-3 bg-black/20 rounded border border-gray-600 text-white">
          <div class="flex gap-2">
            <input id="new-product-price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="w-1/2 p-3 bg-black/20 rounded border border-gray-600 text-white">
            <select id="new-product-category" class="w-1/2 p-3 bg-black/20 rounded border border-gray-600 text-white">
              <option value="Ø±Ø¬Ø§Ù„ÙŠ">Ø±Ø¬Ø§Ù„ÙŠ</option><option value="Ø­Ø±ÙŠÙ…ÙŠ">Ø­Ø±ÙŠÙ…ÙŠ</option><option value="Ø£Ø·ÙØ§Ù„ÙŠ">Ø£Ø·ÙØ§Ù„ÙŠ</option>
            </select>
          </div>
          <input id="new-product-image" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" class="w-full p-3 bg-black/20 rounded border border-gray-600 text-white text-left" dir="ltr">
          <div><p class="text-sm mb-2">Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª:</p><div id="size-selector" class="flex flex-wrap gap-2"></div></div>
          <button onclick="addNewProduct()" class="w-full btn-primary py-3 rounded font-bold">Ø­ÙØ¸</button>
        </div>
      </div>
    </div>
   </div>

   <div id="success-toast" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-600 px-6 py-3 rounded-full shadow-xl translate-y-[-150%] transition-transform z-[70] flex items-center gap-2 border border-green-400">
    <span>âœ…</span><span id="toast-message" class="font-bold">ØªÙ… Ø¨Ù†Ø¬Ø§Ø­</span>
   </div>
   
   <div id="confirm-delete-modal" class="fixed inset-0 z-[70] hidden modal-overlay flex items-center justify-center p-4">
    <div class="bg-[#1e1e1e] border border-gray-700 rounded-xl p-6 text-center max-w-xs w-full">
     <h3 class="font-bold mb-4">Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ±ØŸ</h3>
     <div class="flex gap-2">
       <button onclick="confirmDelete()" class="flex-1 bg-red-600 py-2 rounded text-sm font-bold">Ø­Ø°Ù</button>
       <button onclick="cancelDelete()" class="flex-1 bg-gray-700 py-2 rounded text-sm">Ø¥Ù„ØºØ§Ø¡</button>
     </div>
    </div>
   </div>

  </div>

  <script>
    // === ÙƒÙˆØ¯ Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª (Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø§Ø¨Ù‚) ===
    const defaultConfig = { store_name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ®', whatsapp_number: '01000000000' };
    let products = [], orders = [], currentCategory = '', selectedSizes = [], deleteCallback = null;

    // ØªÙ‡ÙŠØ¦Ø© Data SDK
    const dataHandler = {
      onDataChanged(data) {
        products = data.filter(i => i.type === 'product');
        orders = data.filter(i => i.is_order === true);
        if (currentCategory) renderProducts(currentCategory);
        renderAdminProducts(); renderAdminOrders();
      }
    };

    async function initApp() {
      if (window.dataSdk) await window.dataSdk.init(dataHandler);
      updateSizeSelector();
    }

    // Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØ§Ù„Ø¹Ø±Ø¶
    function selectCategory(cat) {
      currentCategory = cat;
      document.getElementById('products-section').classList.remove('hidden');
      document.getElementById('category-title').textContent = cat;
      renderProducts(cat);
      document.getElementById('products-section').scrollIntoView({behavior:'smooth'});
    }
    function goHome() {
      document.getElementById('products-section').classList.add('hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    function renderProducts(cat) {
      const grid = document.getElementById('products-grid');
      const items = products.filter(p => p.category === cat);
      grid.innerHTML = items.length ? items.map(p => `
        <div class="product-card rounded-xl overflow-hidden cursor-pointer group" onclick="openProductModal('${p.__backendId}')">
          <div class="h-40 bg-gray-800 flex items-center justify-center overflow-hidden relative">
            ${p.image ? `<img src="${p.image}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">` : '<span class="text-4xl">ğŸ‘Ÿ</span>'}
            <div class="absolute bottom-0 left-0 bg-brand text-white text-xs px-2 py-1 rounded-tr font-bold">${p.price} Ø¬.Ù…</div>
          </div>
          <div class="p-3">
            <h4 class="font-bold text-sm truncate">${p.name}</h4>
          </div>
        </div>
      `).join('') : '';
      document.getElementById('no-products').classList.toggle('hidden', items.length > 0);
    }

    // ØªÙØ§ØµÙŠÙ„ ÙˆØ·Ù„Ø¨
    let selProd = null, selSize = null;
    function openProductModal(id) {
      selProd = products.find(p => p.__backendId === id);
      if(!selProd) return;
      selSize = null;
      document.getElementById('modal-product-name').textContent = selProd.name;
      document.getElementById('modal-product-price').textContent = selProd.price + ' Ø¬Ù†ÙŠÙ‡';
      document.getElementById('modal-product-image').innerHTML = selProd.image ? `<img src="${selProd.image}" class="max-h-full max-w-full object-contain">` : '<span class="text-6xl">ğŸ‘Ÿ</span>';
      
      const sizes = selProd.sizes ? selProd.sizes.split(',') : [];
      const allSizes = getSizesForCategory(selProd.category);
      document.getElementById('modal-sizes').innerHTML = allSizes.map(s => {
        const avail = sizes.includes(s.toString());
        return `<button onclick="${avail?`selectSize('${s}', this)`:''}" class="w-10 h-10 rounded-lg font-bold text-sm border border-gray-700 transition-all ${avail?'hover:border-brand bg-[#2a2a2a]':'bg-[#151515] text-gray-600 cursor-not-allowed line-through'}">${s}</button>`;
      }).join('');
      document.getElementById('product-modal').classList.remove('hidden');
    }
    
    function selectSize(s, btn) {
      selSize = s;
      document.querySelectorAll('#modal-sizes button').forEach(b => b.classList.remove('bg-brand', 'text-white', 'border-brand'));
      btn.classList.remove('bg-[#2a2a2a]');
      btn.classList.add('bg-brand', 'text-white', 'border-brand');
    }
    
    function closeProductModal() { document.getElementById('product-modal').classList.add('hidden'); }

    async function submitOrder() {
      const name = document.getElementById('customer-name').value;
      const phone = document.getElementById('customer-phone').value;
      const addr = document.getElementById('customer-address').value;
      
      if(!selProd || !selSize || !name || !phone || !addr) return showToast('âš ï¸ Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
      
      if(window.dataSdk) {
        await window.dataSdk.create({
          type: 'order', is_order: true,
          name: selProd.name, price: selProd.price, category: selProd.category,
          selected_size: selSize, customer_name: name, customer_phone: phone, customer_address: addr,
          order_date: new Date().toISOString()
        });
        showToast('âœ… ØªÙ… Ø§Ù„Ø·Ù„Ø¨');
        closeProductModal();
        window.open(`https://wa.me/${defaultConfig.whatsapp_number}?text=${encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯: ${selProd.name} Ù…Ù‚Ø§Ø³ ${selSize}`)}`, '_blank');
      }
    }

    // Ø£Ø¯Ù…Ù†
    function showAdminLogin() { document.getElementById('admin-login-modal').classList.remove('hidden'); }
    function closeAdminLogin() { document.getElementById('admin-login-modal').classList.add('hidden'); }
    function checkAdminPassword() {
      if(document.getElementById('admin-password').value === 'admin123') {
        closeAdminLogin(); document.getElementById('admin-page').classList.remove('hidden'); showAdminTab('products');
      }
    }
    function exitAdmin() { document.getElementById('admin-page').classList.add('hidden'); }
    
    function showAdminTab(tab) {
      ['products','orders','add'].forEach(t => document.getElementById('admin-'+t).classList.add('hidden'));
      document.getElementById('admin-'+tab).classList.remove('hidden');
      if(tab==='add') updateSizeSelector();
    }

    function renderAdminProducts() {
      document.getElementById('admin-products').innerHTML = products.map(p => `
        <div class="bg-[#1e1e1e] p-3 rounded flex justify-between items-center border border-gray-700">
          <div class="flex items-center gap-3">
             <div class="w-10 h-10 bg-gray-800 rounded overflow-hidden">${p.image?`<img src="${p.image}" class="w-full h-full object-cover">`:'ğŸ‘Ÿ'}</div>
             <div><div class="font-bold text-sm">${p.name}</div><div class="text-xs text-brand">${p.price} Ø¬.Ù…</div></div>
          </div>
          <button onclick="confirmDel('product','${p.__backendId}')" class="text-red-500">ğŸ—‘ï¸</button>
        </div>
      `).join('');
    }
    
    function renderAdminOrders() {
      document.getElementById('admin-orders').innerHTML = orders.map(o => `
        <div class="bg-[#1e1e1e] p-3 rounded border-r-2 border-brand mb-2">
          <div class="flex justify-between"><span class="font-bold">${o.name}</span><button onclick="confirmDel('order','${o.__backendId}')" class="text-red-500">ğŸ—‘ï¸</button></div>
          <div class="text-xs text-gray-400 mt-1">ğŸ‘¤ ${o.customer_name} | ğŸ“ ${o.customer_phone}</div>
        </div>
      `).join('');
    }

    // Ø¥Ø¶Ø§ÙØ© ÙˆØ­Ø°Ù
    function getSizesForCategory(c) { return c==='Ø±Ø¬Ø§Ù„ÙŠ'?[41,42,43,44,45]:(c==='Ø­Ø±ÙŠÙ…ÙŠ'?[37,38,39,40,41]:Array.from({length:20},(_,i)=>i+17)); }
    function updateSizeSelector() {
      const c = document.getElementById('new-product-category').value;
      selectedSizes = [];
      document.getElementById('size-selector').innerHTML = getSizesForCategory(c).map(s => 
        `<button onclick="toggleNewSize(${s},this)" class="w-8 h-8 bg-gray-700 rounded text-xs">${s}</button>`
      ).join('');
    }
    function toggleNewSize(s, btn) {
      if(selectedSizes.includes(s)) { selectedSizes = selectedSizes.filter(x=>x!==s); btn.classList.remove('bg-brand'); }
      else { selectedSizes.push(s); btn.classList.add('bg-brand'); }
    }
    async function addNewProduct() {
      const name = document.getElementById('new-product-name').value;
      const price = document.getElementById('new-product-price').value;
      if(!name || !price) return showToast('âš ï¸ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©');
      await window.dataSdk.create({
        type:'product', is_order:false, name, price, 
        category: document.getElementById('new-product-category').value,
        image: document.getElementById('new-product-image').value,
        sizes: selectedSizes.join(',')
      });
      showToast('âœ… ØªÙ…'); showAdminTab('products');
    }

    function confirmDel(type, id) {
      document.getElementById('confirm-delete-modal').classList.remove('hidden');
      deleteCallback = async () => {
        const item = (type==='product'?products:orders).find(i=>i.__backendId===id);
        if(item) await window.dataSdk.delete(item);
        document.getElementById('confirm-delete-modal').classList.add('hidden');
      };
    }
    function cancelDelete() { document.getElementById('confirm-delete-modal').classList.add('hidden'); }
    function confirmDelete() { if(deleteCallback) deleteCallback(); }
    
    function showToast(m) {
      const t = document.getElementById('success-toast');
      document.getElementById('toast-message').innerText = m;
      t.style.transform = 'translate(-50%, 20px)';
      setTimeout(()=>t.style.transform='translate(-50%, -150%)', 2000);
    }

    document.getElementById('new-product-category').addEventListener('change', updateSizeSelector);
    initApp();
  </script>
 </body>
</html>
