<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#4b5f28">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="Ø§Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® (3).png">
  <link rel="manifest" href="manifest.json">
  <title>Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® - Ù„Ù„Ø£Ø­Ø°ÙŠØ©</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&amp;display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: { 
        extend: { 
          colors: { brand: { light: '#F3F4F6', DEFAULT: '#4b5f28', text: '#2d3748', accent: '#708238' } },
          boxShadow: { 'soft': '0 4px 6px -1px rgba(0,0,0,0.05)', 'button': '0 10px 15px -3px rgba(0,0,0,0.05)' }
        } 
      } 
    }
  </script>
  <style>
    body { font-family: 'Cairo', sans-serif; background-color: #f0f2f5; color: #1a1a1a; background-image: radial-gradient(#e5e7eb 1px, transparent 1px); background-size: 20px 20px; }
    .profile-container { width: 140px; height: 140px; margin: 0 auto; border-radius: 50%; background: white; padding: 5px; box-shadow: 0 10px 25px rgba(0,0,0,0.08); border: 4px solid white; position: relative; overflow: hidden; }
    .profile-img { width: 100%; height: 100%; border-radius: 50%; object-fit: contain; background-color: #fff; }
    .link-btn { display: flex; align-items: center; gap: 1.5rem; width: 100%; background: rgba(255,255,255,0.4); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); padding: 1rem 1.5rem; border-radius: 1.5rem; margin-bottom: 1rem; border: 2px solid rgba(112,130,56,0.5); transform-style: preserve-3d; transform: perspective(600px) translateZ(8px); box-shadow: 0 20px 40px -10px rgba(75,95,40,0.2), 0 10px 25px -10px rgba(0,0,0,0.15), inset 0 2px 0 rgba(255,255,255,0.6); transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); cursor: pointer; }
    .link-btn:hover { transform: perspective(600px) translateZ(25px) translateY(-6px); border-color: #708238; box-shadow: 0 0 30px 8px rgba(112,130,56,0.4), 0 0 60px 15px rgba(112,130,56,0.2), 0 25px 50px -10px rgba(75,95,40,0.3), inset 0 2px 0 rgba(255,255,255,0.8); background: rgba(255,255,255,0.6); }
    .link-btn:active { transform: perspective(600px) translateZ(2px) translateY(2px); box-shadow: 0 0 25px 6px rgba(112,130,56,0.5), inset 0 4px 12px rgba(75,95,40,0.2); }
    .btn-icon-box { width: 50px; height: 50px; background: rgba(255,255,255,0.5); backdrop-filter: blur(8px); border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; border: 2px solid rgba(112,130,56,0.5); flex-shrink: 0; transform-style: preserve-3d; box-shadow: 0 6px 20px rgba(75,95,40,0.2), inset 0 2px 0 rgba(255,255,255,0.5); }
    .btn-icon-img { width: 100%; height: 100%; object-fit: cover; }
    .link-btn h3 { font-size: 1.1rem; font-weight: 800; color: #3f4a20; text-transform: uppercase; flex-grow: 1; text-align: right; }
    .modal-overlay { background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
    .verified-badge { display: inline-flex; align-items: center; justify-content: center; width: 20px; height: 20px; background: #4b5f28; color: white; border-radius: 50%; font-size: 12px; margin-right: 5px; }
    .back-logo-wrap { perspective: 600px; }
    .back-logo { transform-style: preserve-3d; transform: perspective(600px) rotateY(0deg) rotateX(0deg); animation: logo-3d-float 3s ease-in-out infinite; transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.4s ease; }
    .back-logo:hover { animation: none; transform: perspective(600px) rotateY(-12deg) rotateX(5deg) translateZ(8px); box-shadow: 0 12px 24px rgba(75, 95, 40, 0.2); }
    @keyframes logo-3d-float { 0%, 100% { transform: perspective(600px) rotateY(0deg) rotateX(0deg) translateZ(0); } 50% { transform: perspective(600px) rotateY(4deg) rotateX(-2deg) translateZ(4px); } }
    .glass-btn { background: rgba(255,255,255,0.4); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 2px solid rgba(112,130,56,0.5); transform-style: preserve-3d; transform: perspective(600px) translateZ(6px); box-shadow: 0 12px 30px -5px rgba(75,95,40,0.2), inset 0 2px 0 rgba(255,255,255,0.5); transition: all 0.3s ease; }
    .glass-btn:hover { transform: perspective(600px) translateZ(18px) scale(1.08); border-color: #708238; box-shadow: 0 0 25px 6px rgba(112,130,56,0.45), 0 0 50px 12px rgba(112,130,56,0.25), 0 20px 40px -10px rgba(75,95,40,0.3), inset 0 2px 0 rgba(255,255,255,0.7); background: rgba(255,255,255,0.6); }
    .glass-btn:active { transform: perspective(600px) translateZ(0) scale(0.98); box-shadow: 0 0 20px 4px rgba(112,130,56,0.5), inset 0 3px 10px rgba(75,95,40,0.15); }
    .logo-bg-section { position: relative; perspective: 1000px; }
    body.dark { background-color: #1a1a1a; color: #e5e7eb; }
    body.dark .profile-container, body.dark .link-btn, body.dark .glass-btn { background: rgba(30,30,30,0.6); }
    .toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); padding: 14px 24px; border-radius: 12px; font-weight: bold; z-index: 9999; animation: toastIn 0.3s ease; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
    .toast.success { background: #4b5f28; color: white; }
    .toast.error { background: #dc2626; color: white; }
    @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(20px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }
    .skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 8px; }
    @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    .img-zoom-wrap { cursor: zoom-in; overflow: hidden; }
    .img-zoom-wrap img { transition: transform 0.3s ease; }
    .img-zoom-wrap.zoomed { cursor: zoom-out; overflow: auto; }
    .img-zoom-wrap.zoomed img { transform: scale(2); }

    /* --- ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù… --- */
    #cart-modal { align-items: flex-end; z-index: 9999 !important; } /* Ø®Ù„ÙŠÙ†Ø§Ù‡Ø§ Ø£Ø¹Ù„Ù‰ Ø­Ø§Ø¬Ø© */
    #cart-modal .modal-content {
        width: 100%;
        max-width: 100%;
        border-radius: 2rem 2rem 0 0; 
        max-height: 90vh; 
        display: flex;
        flex-direction: column;
        animation: slideUp 0.3s ease-out;
    }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    
    .cart-item-big {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        background: #fff;
        border-bottom: 1px solid #f0f0f0;
        align-items: center;
        position: relative;
    }
    .cart-qty-btn {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: #f3f4f6;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        font-weight: bold;
        color: #4b5f28;
        transition: 0.2s;
        border: 1px solid #e5e7eb;
    }
    .cart-qty-btn:active { background: #d1d5db; transform: scale(0.95); }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù… */
    .floating-cart-btn {
        position: fixed;
        bottom: 25px;
        left: 25px;
        z-index: 9990; /* Ø±Ù‚Ù… Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§ Ø¹Ø´Ø§Ù† ÙŠØ¸Ù‡Ø± ÙÙˆÙ‚ ÙƒÙ„ Ø­Ø§Ø¬Ø© */
        display: flex !important; /* Ø¶Ù…Ø§Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± */
        animation: floatBtn 3s ease-in-out infinite;
    }
    @keyframes floatBtn {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }
  </style>
 </head>
 <body class="h-full min-h-screen overflow-auto transition-colors duration-300">
   <div id="toast-container"></div>

   <button onclick="openCart()" class="floating-cart-btn w-16 h-16 bg-[#4b5f28] text-white rounded-full shadow-[0_10px_20px_rgba(75,95,40,0.4)] flex items-center justify-center hover:scale-110 transition duration-300 border-4 border-white/50 backdrop-blur-sm group">
     <svg class="w-8 h-8 group-hover:scale-110 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
     <span id="cart-badge" class="absolute -top-1 -right-1 w-6 h-6 bg-red-600 rounded-full text-white text-xs font-bold flex items-center justify-center border-2 border-white shadow-sm hidden">0</span>
   </button>

   <div id="home-view" class="relative max-w-md mx-auto px-6 py-10 min-h-screen flex flex-col items-center">
     <button onclick="toggleDark()" id="dark-toggle-home" class="absolute top-4 left-4 w-10 h-10 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-100 transition z-10" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">ğŸŒ™</button>
     <div class="text-center mb-10 w-full relative pt-10">
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-48 h-48 bg-brand-accent/10 rounded-full blur-3xl -z-10"></div>
        <div class="profile-container mb-4">
            <img src="Ø§Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® (3).png" class="profile-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2589/2589903.png'">
        </div>
        <h1 class="text-3xl font-black text-brand mb-1 flex items-center justify-center gap-2">
            <span class="verified-badge">âœ“</span> Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ®
        </h1>
        <p class="text-gray-500 font-bold text-sm tracking-widest uppercase">CHIC & ELEGANT SHOES</p>
     </div>

     <div class="w-full space-y-4 relative logo-bg-section">
       <img src="Ø§Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® (3).png" alt="" class="absolute w-[260px] h-[260px] object-contain pointer-events-none z-0" style="top:50%; left:50%; transform:translate(-50%,-50%); opacity:0.55;">
       <button onclick="showCategory('Ø±Ø¬Ø§Ù„ÙŠ')" class="link-btn group relative z-10" data-cat="Ø±Ø¬Ø§Ù„ÙŠ">
         <div class="btn-icon-box shadow-sm group-hover:scale-110 transition"><img src="men.jpg" class="btn-icon-img" onerror="this.parentElement.innerHTML='ğŸ‘'"></div>
         <h3>MEN COLLECTION</h3><span class="text-gray-400" id="cat-count-Ø±Ø¬Ø§Ù„ÙŠ"></span><span class="text-gray-400">â†’</span>
       </button>
       <button onclick="showCategory('Ø­Ø±ÙŠÙ…ÙŠ')" class="link-btn group" data-cat="Ø­Ø±ÙŠÙ…ÙŠ">
         <div class="btn-icon-box shadow-sm group-hover:scale-110 transition"><img src="women.jpg" class="btn-icon-img" onerror="this.parentElement.innerHTML='ğŸ‘ '"></div>
         <h3>WOMEN COLLECTION</h3><span class="text-gray-400" id="cat-count-Ø­Ø±ÙŠÙ…ÙŠ"></span><span class="text-gray-400">â†’</span>
       </button>
       <button onclick="showCategory('Ø£Ø·ÙØ§Ù„ÙŠ')" class="link-btn group" data-cat="Ø£Ø·ÙØ§Ù„ÙŠ">
         <div class="btn-icon-box shadow-sm group-hover:scale-110 transition"><img src="kids.jpg" class="btn-icon-img" onerror="this.parentElement.innerHTML='ğŸ‘Ÿ'"></div>
         <h3>KIDS COLLECTION</h3><span class="text-gray-400" id="cat-count-Ø£Ø·ÙØ§Ù„ÙŠ"></span><span class="text-gray-400">â†’</span>
       </button>

       <div class="flex gap-3 mt-6 w-full relative z-10">
           <a href="https://wa.me/201020468021" target="_blank" class="flex-1 glass-btn p-4 rounded-xl flex justify-center text-green-600 hover:scale-105 transition">
               <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
           </a>
       </div>
     </div>
   </div>

   <div id="products-view" class="hidden max-w-6xl mx-auto px-4 py-6 min-h-screen">
     <div class="bg-white/40 backdrop-blur-xl px-4 py-3 rounded-2xl sticky top-4 z-40 flex justify-between items-center mb-4 shadow-lg border-2 border-[#708238]/50">
       <div class="flex items-center gap-3">
           <button onclick="toggleDark()" class="w-10 h-10 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-100 transition" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">ğŸŒ™</button>
           <div class="back-logo-wrap flex-shrink-0">
             <button onclick="goHome()" class="back-logo w-12 h-12 rounded-full bg-white/60 backdrop-blur-md flex items-center justify-center overflow-hidden border-2 border-[#708238]/60 hover:border-[#708238] cursor-pointer shadow-lg" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
               <img src="Ø§Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ® (3).png" alt="Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ®" class="w-full h-full object-contain p-1" onerror="this.parentElement.innerHTML='â†'">
             </button>
           </div>
           <h3 id="cat-title" class="text-xl font-bold text-brand-dark"></h3>
       </div>
     </div>
     <div class="mb-4">
       <input type="text" id="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ¯ÙŠÙ„..." class="w-full p-3 rounded-xl border-2 border-gray-200 focus:border-brand outline-none transition">
     </div>
     <div id="loading-skeleton" class="grid grid-cols-2 md:grid-cols-4 gap-4 hidden">
       <div class="rounded-2xl overflow-hidden"><div class="h-44 skeleton"></div><div class="p-4"><div class="h-4 skeleton w-3/4 mb-2"></div><div class="h-4 skeleton w-1/2"></div></div></div>
       <div class="rounded-2xl overflow-hidden"><div class="h-44 skeleton"></div><div class="p-4"><div class="h-4 skeleton w-3/4 mb-2"></div><div class="h-4 skeleton w-1/2"></div></div></div>
       <div class="rounded-2xl overflow-hidden"><div class="h-44 skeleton"></div><div class="p-4"><div class="h-4 skeleton w-3/4 mb-2"></div><div class="h-4 skeleton w-1/2"></div></div></div>
       <div class="rounded-2xl overflow-hidden"><div class="h-44 skeleton"></div><div class="p-4"><div class="h-4 skeleton w-3/4 mb-2"></div><div class="h-4 skeleton w-1/2"></div></div></div>
     </div>
     <div id="loading-msg" class="text-center py-20 text-brand hidden font-bold">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
     <div id="grid" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
     <div id="empty-msg" class="hidden text-center py-20">
         <div class="text-6xl mb-4 opacity-30 grayscale">ğŸ‘Ÿ</div>
         <p class="text-gray-400 font-bold">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>
     </div>
   </div>

   <div id="modal" class="hidden fixed inset-0 z-50 modal-overlay flex items-center justify-center p-4">
     <div class="bg-white w-full max-w-md rounded-[2rem] overflow-hidden shadow-2xl max-h-[95vh] overflow-y-auto relative flex flex-col">
       <button onclick="closeModal()" class="absolute top-4 left-4 bg-white/90 w-10 h-10 rounded-full z-20 text-gray-800 shadow-lg transition font-bold text-xl flex items-center justify-center hover:bg-red-50 hover:text-red-500">âœ•</button>
       
       <div class="bg-gray-50 h-72 flex items-center justify-center relative shrink-0" id="img-zoom-wrap" onclick="toggleImgZoom()">
         <img id="main-img" class="max-h-full max-w-full object-contain drop-shadow-xl mix-blend-multiply transition-transform duration-300">
         <div id="thumbs" class="absolute bottom-4 flex gap-2 justify-center w-full px-2"></div>
       </div>

       <div class="p-6">
         <h2 id="m-name" class="text-2xl font-bold text-center mb-1 text-gray-800"></h2>
         <p id="m-price" class="text-3xl font-black text-brand text-center mb-6"></p>
         
         <div id="m-colors-wrap" class="mb-4 text-center hidden">
             <p class="text-xs text-gray-400 mb-2 font-bold uppercase tracking-widest">Ø§Ø®ØªØ± Ø§Ù„Ù„ÙˆÙ†</p>
             <div id="m-colors" class="flex flex-wrap justify-center gap-2"></div>
         </div>
         <div class="mb-6 text-center">
             <p class="text-xs text-gray-400 mb-2 font-bold uppercase tracking-widest">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³</p>
             <div id="m-sizes" class="flex flex-wrap justify-center gap-2"></div>
         </div>

         <button onclick="addToCart()" id="add-cart-btn" class="w-full py-4 rounded-xl font-bold text-lg shadow-xl text-white bg-gradient-to-r from-brand to-brand-accent hover:shadow-2xl transition transform hover:-translate-y-1 flex items-center justify-center gap-2">
           Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© ğŸ›’
         </button>
       </div>
     </div>
   </div>

   <div id="cart-modal" class="hidden fixed inset-0 z-50 modal-overlay flex p-0">
     <div class="modal-content bg-white overflow-hidden shadow-2xl relative flex flex-col">
       <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
         <h2 class="text-xl font-bold text-gray-800">ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
         <button onclick="closeCart()" class="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center font-bold text-gray-600 hover:bg-red-50 hover:text-red-500">âœ•</button>
       </div>
       
       <div id="cart-items" class="p-4 flex-1 overflow-y-auto bg-white">
         <div id="cart-empty" class="text-center py-12">
           <div class="text-7xl mb-4 opacity-20">ğŸ›’</div>
           <p class="text-gray-500 font-bold mb-2">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>
           <p class="text-sm text-gray-400">Ø§Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±</p>
         </div>
       </div>
       
       <div class="p-4 border-t border-gray-100 bg-white">
         <button onclick="closeCart()" class="w-full py-2 mb-3 text-gray-400 text-xs hover:text-brand transition text-center">â† Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ø¹ÙˆØ¯Ø© ÙˆÙ…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª</button>
         
         <div class="p-4 bg-gray-50 rounded-xl space-y-3 mb-3">
           <p class="text-sm font-bold text-gray-600">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</p>
           <input id="c-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ" class="w-full bg-white border border-gray-200 p-3 rounded-xl text-sm font-bold text-gray-700 outline-none focus:border-brand transition">
           <input id="c-phone" type="tel" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (11 Ø±Ù‚Ù…)" maxlength="11" class="w-full bg-white border border-gray-200 p-3 rounded-xl text-sm font-bold text-gray-700 outline-none focus:border-brand transition">
           <input id="c-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„" class="w-full bg-white border border-gray-200 p-3 rounded-xl text-sm font-bold text-gray-700 outline-none focus:border-brand transition">
         </div>
         
         <div class="flex justify-between items-center p-3 mb-3">
             <span class="font-bold text-gray-700">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚ Ù„Ù„Ø¯ÙØ¹:</span>
             <span id="cart-total-confirm" class="text-xl font-black text-brand">0 Ø¬.Ù…</span>
         </div>
         
         <div class="p-3 bg-green-50 border border-green-200 rounded-xl text-center mb-3">
           <p class="text-xs text-gray-600 font-bold">ğŸ’³ Ø§Ù„Ø¯ÙØ¹ ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´: <span class="text-green-600 font-mono text-lg" dir="ltr">01020468021</span></p>
         </div>
         
         <button onclick="confirmOrder()" id="confirm-order-btn" class="w-full py-4 rounded-xl font-bold text-lg shadow-xl text-white bg-gradient-to-r from-brand to-brand-accent hover:shadow-2xl transition">
           ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„ âœ…
         </button>
       </div>
     </div>
   </div>

   <div id="order-success-modal" class="hidden fixed inset-0 z-[60] modal-overlay flex items-center justify-center p-4">
     <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center shadow-2xl">
       <div class="text-6xl mb-4">âœ…</div>
       <h3 class="text-xl font-bold text-gray-800 mb-2">ØªÙ… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!</h3>
       <p class="text-sm text-gray-500 mb-4">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</p>
       <p id="order-number-display" class="text-3xl font-black text-brand mb-4 font-mono tracking-widest">#0000</p>
       <button onclick="copyOrderNumber()" class="text-sm text-gray-500 hover:text-brand mb-4">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…</button>
       <button onclick="closeOrderSuccess()" class="w-full py-3 rounded-xl bg-brand text-white font-bold">Ø­Ø³Ù†Ø§Ù‹</button>
     </div>
   </div>

   <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyASO-AN5XaSGn4SaCZ8VlHr6zsFCIxPCzs",
      authDomain: "ahmed-shoes.firebaseapp.com",
      projectId: "ahmed-shoes",
      storageBucket: "ahmed-shoes.firebasestorage.app",
      messagingSenderId: "172928088473",
      appId: "1:172928088473:web:100f543fd097a8d5c33b08",
      measurementId: "G-S50TX0VMKE"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let products = [];
    window.currentProd = null;
    window.currentSize = null;
    window.currentColor = null;
    
    // --- âœ… Ø­Ù„ Ø¬Ø°Ø±ÙŠ Ù„Ù„ØªØ¹Ù„ÙŠÙ‚: ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ù„Ø© Ù„Ùˆ ÙÙŠÙ‡Ø§ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§ÙŠØ¸Ø© ---
    try { 
        let rawCart = localStorage.getItem('cart');
        if (rawCart) {
            let parsed = JSON.parse(rawCart);
            // Ù„Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´ Ù…ØµÙÙˆÙØ©ØŒ Ø§Ù…Ø³Ø­Ù‡Ø§ ÙˆØ§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯
            if (!Array.isArray(parsed)) {
                window.cart = [];
                localStorage.setItem('cart', '[]');
            } else {
                // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¥Ø¶Ø§ÙØ© ID Ø¬Ø¯ÙŠØ¯
                window.cart = parsed.map(item => ({
                    ...item,
                    cartId: item.cartId || (Date.now() + Math.random().toString(36).substr(2, 9))
                }));
            }
        } else {
            window.cart = [];
        }
    } catch(e) { 
        // Ù„Ùˆ Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ ÙØ±Ù…Øª Ø§Ù„Ø³Ù„Ø© ÙÙˆØ±Ø§Ù‹
        window.cart = []; 
        localStorage.removeItem('cart');
    }

    function toast(msg, type='success') {
        const c = document.getElementById('toast-container');
        const t = document.createElement('div');
        t.className = `toast ${type}`;
        t.textContent = msg;
        c.appendChild(t);
        setTimeout(() => { t.remove(); }, 3000);
    }

    function saveCart() { try { localStorage.setItem('cart', JSON.stringify(window.cart)); } catch(e) {} }

    window.toggleDark = function() {
        document.body.classList.toggle('dark');
        const isDark = document.body.classList.contains('dark');
        document.querySelectorAll('[title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ"]').forEach(e => e.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™');
        try { localStorage.setItem('darkMode', isDark); } catch(e){}
    };
    if(localStorage.getItem('darkMode')==='true') { document.body.classList.add('dark'); document.querySelectorAll('[title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ"]').forEach(e => e.textContent='â˜€ï¸'); }

    window.toggleImgZoom = function() { document.getElementById('img-zoom-wrap').classList.toggle('zoomed'); }

    window.copyOrderNumber = function() {
        const n = document.getElementById('order-number-display').textContent;
        navigator.clipboard?.writeText(n).then(() => toast('ØªÙ… Ø§Ù„Ù†Ø³Ø®!'));
    }

    window.closeOrderSuccess = function() {
        document.getElementById('order-success-modal').classList.add('hidden');
    }

    function updateCartBadge() {
        const badge = document.getElementById('cart-badge');
        if(!badge) return;
        const count = Array.isArray(window.cart) ? window.cart.reduce((s, i) => s + (i.qty || 1), 0) : 0;
        badge.innerText = count;
        if(count === 0) {
            badge.classList.add('hidden');
        } else {
            badge.classList.remove('hidden');
            badge.classList.add('flex');
        }
    }
    updateCartBadge();

    window.addToCart = function() {
        if(!window.currentSize) return toast('Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³ Ø£ÙˆÙ„Ø§Ù‹', 'error');
        const color = window.currentColor || 'Ø§ÙØªØ±Ø§Ø¶ÙŠ';
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© Ø¥Ø¶Ø§ÙØ©
        window.cart.push({
            cartId: Date.now() + Math.random().toString(36).substr(2, 9), 
            productId: window.currentProd.id,
            productName: window.currentProd.name,
            price: parseInt(window.currentProd.price) || 0,
            color, size: window.currentSize,
            image: (window.currentProd.images||[])[0],
            qty: 1
        });
        toast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© âœ“');
        updateCartBadge();
        saveCart();
        closeModal();
    }

    // --- âœ… Ø¯ÙˆØ§Ù„ Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© (ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ cartId) Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ¯Ø§Ø®Ù„ ---
    window.updateCartQty = function(cId, delta) {
        const idx = window.cart.findIndex(i => i.cartId === cId);
        if (idx === -1) return; // Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        
        window.cart[idx].qty = (window.cart[idx].qty || 1) + delta;
        
        if (window.cart[idx].qty < 1) {
            window.cart.splice(idx, 1);
        }
        
        renderCart();
        updateCartBadge();
        saveCart(); 
    }

    window.removeFromCart = function(cId) {
        window.cart = window.cart.filter(i => i.cartId !== cId);
        renderCart();
        updateCartBadge();
        saveCart(); 
        toast('ØªÙ… Ø§Ù„Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ù„Ø©');
    }

    // âœ… Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø© Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ§Ù„ÙØ©
    function renderCart() {
        const el = document.getElementById('cart-items');
        const empty = document.getElementById('cart-empty');
        
        if (!Array.isArray(window.cart) || !window.cart.length) {
            el.innerHTML = '';
            empty.classList.remove('hidden');
            document.getElementById('cart-total-confirm').innerText = '0 Ø¬.Ù…';
            return;
        }
        
        empty.classList.add('hidden');
        
        // ØªØµÙÙŠØ© Ø£ÙŠ Ù…Ù†ØªØ¬ Ø¨Ø§ÙŠØ¸ (null) Ø¹Ø´Ø§Ù† Ø§Ù„ØµÙØ­Ø© Ù…ØªÙ‡Ù†Ø¬Ø´
        const validItems = window.cart.filter(item => item && item.price);
        
        const total = validItems.reduce((s, i) => s + (i.price * (i.qty||1)), 0);
        const totalStr = total + ' Ø¬.Ù…';
        document.getElementById('cart-total-confirm').innerText = totalStr;

        el.innerHTML = validItems.map((item) => `
            <div class="cart-item-big relative group rounded-xl mb-3 border border-gray-100 shadow-sm">
                <img src="${item.image||''}" class="w-32 h-32 rounded-xl object-cover shadow-sm bg-gray-100 shrink-0" onerror="this.src='https://via.placeholder.com/150'">
                
                <div class="flex-1 min-w-0 flex flex-col justify-between py-1 h-full gap-2">
                    <div>
                        <p class="font-black text-xl text-gray-800 truncate leading-tight">${item.productName}</p>
                        <p class="text-base text-gray-500 font-bold mt-1">
                           ${item.color} | Ù…Ù‚Ø§Ø³ <span class="text-brand bg-brand/10 px-1 rounded">${item.size}</span>
                        </p>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <p class="text-brand font-black text-2xl">${item.price * (item.qty||1)} <span class="text-sm text-gray-400">Ø¬.Ù…</span></p>
                        
                        <div class="flex items-center gap-3 bg-gray-50 rounded-full px-2 py-1 border border-gray-200">
                            <button onclick="updateCartQty('${item.cartId}', -1)" class="cart-qty-btn hover:bg-red-100 hover:text-red-500 hover:border-red-200">âˆ’</button>
                            <span class="text-xl font-black w-6 text-center text-gray-700">${item.qty||1}</span>
                            <button onclick="updateCartQty('${item.cartId}', 1)" class="cart-qty-btn bg-brand text-white hover:bg-brand-accent hover:text-white border-transparent shadow-md">+</button>
                        </div>
                    </div>
                </div>

                <button onclick="removeFromCart('${item.cartId}')" class="absolute top-2 left-2 text-gray-300 hover:text-red-500 p-2 bg-white/80 rounded-full hover:bg-red-50 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                </button>
            </div>
        `).join('');
    }

    window.openCart = function() {
        renderCart();
        document.getElementById('cart-modal').classList.remove('hidden');
    }

    window.closeCart = function() {
        document.getElementById('cart-modal').classList.add('hidden');
    }

    window.confirmOrder = async function() {
        const name = document.getElementById('c-name').value?.trim();
        const phone = document.getElementById('c-phone').value?.trim();
        const address = document.getElementById('c-address').value?.trim();

        if(!window.cart.length) return toast('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©', 'error');
        if(!name || !address) return toast('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù†', 'error');

        if (!phone || !/^\d{11}$/.test(phone)) {
            return toast('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù… ØµØ­ÙŠØ­', 'error');
        }
        
        const btn = document.getElementById('confirm-order-btn');
        btn.disabled = true;
        btn.innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
        
        try {
            const items = window.cart.map(i => ({
                productName: i.productName,
                price: i.price,
                color: i.color,
                size: i.size,
                qty: i.qty || 1
            }));
            let total = window.cart.reduce((s, i) => s + (i.price * (i.qty||1)), 0);
            
            const orderData = {
                items,
                total,
                customerName: name,
                customerPhone: phone,
                customerAddress: address,
                timestamp: Date.now()
            };
            const docRef = await addDoc(collection(db, "orders"), orderData);
            const orderId = docRef.id.slice(-6).toUpperCase();
            
            const msg = `ğŸ›’ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ #${orderId} - Ø£Ø­Ù…Ø¯ Ø§Ù„Ø´ÙŠØ®*\n\n` + items.map((it,i) => `${i+1}. ${it.productName}\n   Ø§Ù„Ù„ÙˆÙ†: ${it.color} | Ø§Ù„Ù…Ù‚Ø§Ø³: ${it.size} | Ø§Ù„ÙƒÙ…ÙŠØ©: ${it.qty} | ${it.price*it.qty} Ø¬.Ù…`).join('\n\n') + `\n\nğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¬.Ù…\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\nğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}`;
            
            window.open('https://wa.me/201020468021?text=' + encodeURIComponent(msg), '_blank');
            closeCart();
            
            document.getElementById('order-number-display').textContent = '#' + orderId;
            document.getElementById('order-success-modal').classList.remove('hidden');
            
            toast('ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ! ØªÙ… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨');
            window.cart = [];
            updateCartBadge();
            saveCart();
            document.getElementById('c-name').value = '';
            document.getElementById('c-phone').value = '';
            document.getElementById('c-address').value = '';
        } catch (e) {
            toast('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + e.message, 'error');
        }
        btn.disabled = false;
        btn.innerText = 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„ âœ…';
    }

    function updateCategoryCounts() {
        ['Ø±Ø¬Ø§Ù„ÙŠ','Ø­Ø±ÙŠÙ…ÙŠ','Ø£Ø·ÙØ§Ù„ÙŠ'].forEach(cat => {
            const el = document.getElementById('cat-count-'+cat);
            if(el) el.textContent = products.filter(p=>p.category===cat).length ? ` (${products.filter(p=>p.category===cat).length})` : '';
        });
    }

    function renderProductsGrid(items) {
        const grid = document.getElementById('grid');
        if(!items.length) { document.getElementById('empty-msg').classList.remove('hidden'); grid.innerHTML=''; return; }
        document.getElementById('empty-msg').classList.add('hidden');
        grid.innerHTML = items.map(p => `
                <div onclick="openModal('${p.id}')" class="bg-white rounded-2xl overflow-hidden cursor-pointer shadow-soft hover:shadow-lg transition border border-gray-100">
                    <div class="h-44 bg-gray-50 relative"><img src="${(p.images||[])[0]}" class="w-full h-full object-cover mix-blend-multiply"></div>
                    <div class="p-4"><h4 class="font-bold text-sm truncate">${p.name}</h4><span class="text-brand font-black text-sm">${p.price} Ø¬.Ù…</span></div>
                </div>
            `).join('');
    }

    window.showCategory = async function(cat) {
        document.getElementById('home-view').classList.add('hidden');
        document.getElementById('products-view').classList.remove('hidden');
        document.getElementById('cat-title').innerText = cat;
        updateCartBadge();
        document.getElementById('loading-msg').classList.add('hidden');
        document.getElementById('loading-skeleton').classList.remove('hidden');
        document.getElementById('grid').innerHTML = '';
        document.getElementById('search-input').value = '';

        try {
            const q = query(collection(db, "products"), orderBy("timestamp", "desc"));
            const snapshot = await getDocs(q);
            products = [];
            snapshot.forEach(doc => products.push({id: doc.id, ...doc.data()}));

            document.getElementById('loading-skeleton').classList.add('hidden');
            updateCategoryCounts();
            const items = products.filter(p => p.category === cat);
            renderProductsGrid(items);
        } catch (error) {
            document.getElementById('loading-skeleton').classList.add('hidden');
            document.getElementById('loading-msg').classList.remove('hidden');
            document.getElementById('loading-msg').innerText = "Ø­Ø¯Ø« Ø®Ø·Ø£. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.";
            toast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„', 'error');
        }
    }

    document.getElementById('search-input')?.addEventListener('input', function() {
        const q = this.value.trim().toLowerCase();
        const cat = document.getElementById('cat-title').innerText;
        const base = products.filter(p => p.category === cat);
        const filtered = q ? base.filter(p => (p.name||'').toLowerCase().includes(q)) : base;
        renderProductsGrid(filtered);
    });

    getDocs(query(collection(db, "products"), orderBy("timestamp", "desc"))).then(snap => {
        products = [];
        snap.forEach(doc => products.push({id: doc.id, ...doc.data()}));
        updateCategoryCounts();
    }).catch(()=>{});

    window.goHome = function() { document.getElementById('products-view').classList.add('hidden'); document.getElementById('home-view').classList.remove('hidden'); }

    window.openModal = function(id) {
        window.currentProd = products.find(p => p.id === id);
        window.currentSize = null;
        window.currentColor = null;
        document.getElementById('img-zoom-wrap')?.classList.remove('zoomed');
        document.getElementById('modal').classList.remove('hidden');
        document.getElementById('m-name').innerText = window.currentProd.name;
        document.getElementById('m-price').innerText = window.currentProd.price + ' Ø¬.Ù…';
        document.getElementById('main-img').src = (window.currentProd.images||[])[0];
        document.getElementById('thumbs').innerHTML = (window.currentProd.images||[]).map(src => `<div onclick="event.stopPropagation(); document.getElementById('main-img').src='${src}'" class="w-12 h-12 rounded-lg border cursor-pointer overflow-hidden"><img src="${src}" class="w-full h-full object-cover"></div>`).join('');
        const colors = window.currentProd.colors;
        if(colors && colors.length > 1) {
            document.getElementById('m-colors-wrap').classList.remove('hidden');
            document.getElementById('m-colors').innerHTML = colors.map(c => `<button onclick="selectColor('${c.name}', this)" class="px-4 py-2 rounded-lg text-sm font-bold border-2 border-gray-200 hover:border-brand transition">${c.name}</button>`).join('');
            document.getElementById('m-sizes').innerHTML = '<p class="text-gray-400 text-sm">Ø§Ø®ØªØ± Ø§Ù„Ù„ÙˆÙ† Ø£ÙˆÙ„Ø§Ù‹</p>';
        } else if(colors && colors.length === 1) {
            document.getElementById('m-colors-wrap').classList.add('hidden');
            window.currentColor = colors[0].name;
            renderSizesForColor(colors[0].sizes);
        } else {
            document.getElementById('m-colors-wrap').classList.add('hidden');
            renderSizesForColor(window.currentProd.sizes || []);
        }
    }
    function renderSizesForColor(sizes) {
        document.getElementById('m-sizes').innerHTML = sizes.map(s => `<button onclick="selectSize(${s}, this)" class="w-8 h-8 rounded-lg bg-gray-100 text-xs font-bold text-gray-600 hover:bg-brand hover:text-white transition">${s}</button>`).join('');
    }
    window.selectColor = function(colorName, btn) {
        window.currentColor = colorName;
        window.currentSize = null;
        document.querySelectorAll('#m-colors button').forEach(b => b.classList.remove('bg-brand', 'text-white', 'border-brand'));
        btn.classList.add('bg-brand', 'text-white', 'border-brand');
        const color = window.currentProd.colors.find(c => c.name === colorName);
        renderSizesForColor(color ? color.sizes : []);
    }
    window.selectSize = function(s, btn) {
        window.currentSize = s;
        document.querySelectorAll('#m-sizes button').forEach(b => b.classList.remove('bg-brand', 'text-white'));
        btn.classList.add('bg-brand', 'text-white');
    }

    window.closeModal = function() { document.getElementById('modal').classList.add('hidden'); }
   </script>
 </body>
</html>
